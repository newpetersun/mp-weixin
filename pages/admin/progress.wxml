<view class="admin-progress"><view class="head"><image class="head-svg" src="{{a}}" bindtap="{{b}}"></image><view class="head-button button-line">项目进度管理</view><view class="head-button button-guid" bindtap="{{c}}">添加需求</view></view><view class="progress-content"><view wx:if="{{d}}" class="loading-container"><view class="loading-spinner"></view><view class="loading-text">加载中...</view></view><view wx:elif="{{e}}" class="error-container"><view class="error-icon">⚠️</view><view class="error-text">{{f}}</view><view class="error-retry" bindtap="{{g}}">重试</view></view><view wx:else><view class="project-selector"><view class="selector-title">选择项目</view><picker value="{{i}}" range="{{j}}" range-key="title" bindchange="{{k}}"><view class="selector-input"><view class="selector-text">{{h}}</view><view class="selector-arrow">▼</view></view></picker></view><view wx:if="{{l}}" class="requirements-section"><view class="filter-buttons"><view class="{{['filter-btn', n && 'active']}}" bindtap="{{o}}"><view class="filter-text">全部</view><view class="filter-count">{{m}}</view></view><view class="{{['filter-btn', q && 'active']}}" bindtap="{{r}}"><view class="filter-text">未开始</view><view class="filter-count">{{p}}</view></view><view class="{{['filter-btn', t && 'active']}}" bindtap="{{v}}"><view class="filter-text">进行中</view><view class="filter-count">{{s}}</view></view><view class="{{['filter-btn', x && 'active']}}" bindtap="{{y}}"><view class="filter-text">已完成</view><view class="filter-count">{{w}}</view></view></view><view class="requirements-list"><view wx:for="{{z}}" wx:for-item="requirement" wx:key="q" class="requirement-item"><view class="requirement-header"><view class="requirement-title">{{requirement.a}}</view><view class="requirement-actions"><view class="action-btn detail-btn" bindtap="{{requirement.b}}"> 详情 </view><view class="action-btn edit-btn" bindtap="{{requirement.c}}"> 编辑 </view><view class="action-btn delete-btn" bindtap="{{requirement.d}}"> 删除 </view></view></view><view class="requirement-content">{{requirement.e}}</view><view class="requirement-info"><view class="info-row"><view class="info-item"><text class="info-label">优先级：</text><view class="{{['priority-badge', requirement.g]}}">{{requirement.f}}</view></view><view wx:if="{{requirement.h}}" class="info-item"><text class="info-label">负责人：</text><text class="info-value">{{requirement.i}}</text></view></view><view class="info-row"><view class="info-item"><text class="info-label">预估工时：</text><text class="info-value">{{requirement.j}}h</text></view><view class="info-item"><text class="info-label">实际工时：</text><text class="info-value">{{requirement.k}}h</text></view></view></view><view class="requirement-footer"><view class="requirement-status"><view class="{{['status-badge', requirement.m]}}">{{requirement.l}}</view></view><view class="requirement-meta"><view class="meta-item"><text class="meta-label">创建时间：</text><text class="meta-value">{{requirement.n}}</text></view><view wx:if="{{requirement.o}}" class="meta-item"><text class="meta-label">更新时间：</text><text class="meta-value">{{requirement.p}}</text></view></view></view></view></view><view wx:if="{{A}}" class="empty-state"><view class="empty-icon">📋</view><view class="empty-text">{{B}}</view></view></view><view wx:else class="no-project-selected"><view class="no-project-icon">📁</view><view class="no-project-text">请先选择一个项目</view></view></view></view><view wx:if="{{C}}" class="requirement-modal" bindtap="{{ae}}"><view class="modal-content" catchtap="{{ad}}"><view class="modal-header"><view class="modal-title">{{D}}</view><view class="modal-close" bindtap="{{E}}">×</view></view><view class="modal-body"><view class="form-group"><view class="form-label">需求模板</view><picker value="{{G}}" range="{{H}}" range-key="name" bindchange="{{I}}"><view class="form-picker"><view class="picker-text">{{F}}</view><view class="picker-arrow">▼</view></view></picker></view><view class="form-group"><view class="form-label">需求标题 *</view><input class="form-input" placeholder="请输入需求标题" maxlength="100" value="{{J}}" bindinput="{{K}}"/></view><view class="form-group"><view class="form-label">需求描述 *</view><block wx:if="{{r0}}"><textarea class="form-textarea" placeholder="请输入需求描述" maxlength="500" value="{{L}}" bindinput="{{M}}"></textarea></block></view><view class="form-row"><view class="form-group form-group-half"><view class="form-label">优先级</view><picker value="{{O}}" range="{{P}}" bindchange="{{Q}}"><view class="form-picker"><view class="picker-text">{{N}}</view><view class="picker-arrow">▼</view></view></picker></view><view class="form-group form-group-half"><view class="form-label">需求状态</view><picker value="{{S}}" range="{{T}}" bindchange="{{U}}"><view class="form-picker"><view class="picker-text">{{R}}</view><view class="picker-arrow">▼</view></view></picker></view></view><view class="form-row"><view class="form-group form-group-half"><view class="form-label">预估工时（小时）</view><input class="form-input" placeholder="0" type="number" step="0.5" value="{{V}}" bindinput="{{W}}"/></view><view class="form-group form-group-half"><view class="form-label">负责人</view><view class="form-picker" bindtap="{{Y}}"><view class="picker-text">{{X}}</view><view class="picker-arrow">▼</view></view></view></view></view><view class="modal-footer"><button class="modal-btn cancel-btn" bindtap="{{Z}}">取消</button><button class="modal-btn confirm-btn" bindtap="{{ab}}" disabled="{{ac}}">{{aa}}</button></view></view></view><view wx:if="{{af}}" class="detail-modal" bindtap="{{aF}}"><view class="detail-content" catchtap="{{aE}}"><view class="detail-header"><view class="detail-title">需求详情</view><view class="detail-close" bindtap="{{ag}}">×</view></view><view wx:if="{{ah}}" class="detail-body"><view class="detail-section"><view class="section-title">基本信息</view><view class="detail-info"><view class="info-item"><text class="info-label">需求标题：</text><text class="info-value">{{ai}}</text></view><view class="info-item"><text class="info-label">需求描述：</text><text class="info-value">{{aj}}</text></view><view class="info-item"><text class="info-label">优先级：</text><view class="{{['priority-badge', al]}}">{{ak}}</view></view><view class="info-item"><text class="info-label">状态：</text><view class="{{['status-badge', an]}}">{{am}}</view></view><view wx:if="{{ao}}" class="info-item"><text class="info-label">负责人：</text><text class="info-value">{{ap}}</text></view></view></view><view class="detail-section"><view class="section-title">工时信息</view><view class="time-info"><view class="time-item"><text class="time-label">预估工时：</text><text class="time-value">{{aq}}小时</text></view><view class="time-item"><text class="time-label">实际工时：</text><text class="time-value">{{ar}}小时</text></view><view wx:if="{{as}}" class="time-item"><text class="time-label">工时偏差：</text><text class="{{['time-value', av]}}">{{at}}</text></view></view></view><view wx:if="{{aw}}" class="detail-section"><view class="section-title">附件列表</view><view class="attachments-list"><view wx:for="{{ax}}" wx:for-item="attachment" wx:key="e" class="attachment-item"><view class="attachment-info"><text class="attachment-name">{{attachment.a}}</text><text class="attachment-size">{{attachment.b}}</text></view><view class="attachment-actions"><view class="action-btn download-btn" bindtap="{{attachment.c}}">下载</view><view class="action-btn delete-btn" bindtap="{{attachment.d}}">删除</view></view></view></view></view><view wx:if="{{ay}}" class="detail-section"><view class="section-title">评论记录</view><view class="comments-list"><view wx:for="{{az}}" wx:for-item="comment" wx:key="e" class="comment-item"><view class="comment-header"><image src="{{comment.a}}" class="comment-avatar"></image><view class="comment-info"><text class="comment-author">{{comment.b}}</text><text class="comment-time">{{comment.c}}</text></view></view><view class="comment-content">{{comment.d}}</view></view></view></view><view wx:if="{{aA}}" class="detail-section"><view class="section-title">工时记录</view><view class="time-logs-list"><view wx:for="{{aB}}" wx:for-item="log" wx:key="f" class="time-log-item"><view class="log-header"><text class="log-date">{{log.a}}</text><text class="log-hours">{{log.b}}小时</text></view><view wx:if="{{log.c}}" class="log-content">{{log.d}}</view><view class="log-author">记录人：{{log.e}}</view></view></view></view></view><view class="detail-footer"><button class="detail-btn close-btn" bindtap="{{aC}}">关闭</button><button class="detail-btn edit-btn" bindtap="{{aD}}">编辑</button></view></view></view><view wx:if="{{aG}}" class="assignee-modal" bindtap="{{aM}}"><view class="assignee-content" catchtap="{{aL}}"><view class="assignee-header"><view class="assignee-title">选择负责人</view><view class="assignee-close" bindtap="{{aH}}">×</view></view><view class="assignee-body"><view class="assignee-list"><view wx:for="{{aI}}" wx:for-item="assignee" wx:key="d" class="{{['assignee-item', assignee.e && 'selected']}}" bindtap="{{assignee.f}}"><view class="assignee-info"><image src="{{assignee.a}}" class="assignee-avatar"></image><view class="assignee-name">{{assignee.b}}</view></view><view wx:if="{{assignee.c}}" class="assignee-check">✓</view></view></view></view><view class="assignee-footer"><button class="assignee-btn cancel-btn" bindtap="{{aJ}}">取消</button><button class="assignee-btn confirm-btn" bindtap="{{aK}}">确定</button></view></view></view><view wx:if="{{aN}}" class="delete-modal" bindtap="{{aS}}"><view class="delete-content" catchtap="{{aR}}"><view class="delete-header"><view class="delete-title">确认删除</view><view class="delete-close" bindtap="{{aO}}">×</view></view><view class="delete-body"><view class="delete-message">确定要删除这个需求吗？删除后无法恢复。</view></view><view class="delete-actions"><button class="delete-btn cancel-btn" bindtap="{{aP}}">取消</button><button class="delete-btn confirm-btn" bindtap="{{aQ}}">确认删除</button></view></view></view></view>