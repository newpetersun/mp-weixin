"use strict";const e=require("../../common/vendor.js"),t=require("../../config/config.js");require("../../utils/api.js");const s={data:()=>({searchKeyword:"",showFilter:!1,showMessageModal:!1,statusIndex:0,timeIndex:0,statusOptions:["全部状态","未读","已读"],timeOptions:["全部时间","今天","本周","本月"],selectedMessage:{},messages:[{id:1,name:"张三",email:"zhangsan@example.com",content:"您好，我对您的项目很感兴趣，想了解一下合作的可能性。我们公司正在寻找优秀的前端开发者，希望有机会与您合作。",time:"2024-01-15 14:30",read:!1},{id:2,name:"李四",email:"lisi@example.com",content:"请问您是否接受远程工作？我们公司正在寻找优秀的前端开发者，可以提供有竞争力的薪资待遇。",time:"2024-01-15 10:20",read:!0},{id:3,name:"王五",email:"wangwu@example.com",content:"您的作品集设计很棒，想请教一下技术实现方案。特别是那个数据可视化大屏，效果很震撼。",time:"2024-01-14 16:45",read:!0},{id:4,name:"赵六",email:"zhaoliu@example.com",content:"您好，我是某互联网公司的HR，看到您的作品集后很感兴趣，想邀请您参加我们的面试。",time:"2024-01-14 09:15",read:!1},{id:5,name:"钱七",email:"qianqi@example.com",content:"您的技术栈很全面，特别是Vue3和ThinkPHP的运用。我们团队正好需要这样的人才。",time:"2024-01-13 11:30",read:!1}]}),computed:{filteredMessages(){let e=this.messages;if(this.searchKeyword&&(e=e.filter((e=>e.name.toLowerCase().includes(this.searchKeyword.toLowerCase())||e.content.toLowerCase().includes(this.searchKeyword.toLowerCase())||e.email.toLowerCase().includes(this.searchKeyword.toLowerCase())))),this.statusIndex>0){const t=2===this.statusIndex;e=e.filter((e=>e.read===t))}if(this.timeIndex>0){const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(s.getTime()-24*s.getDay()*60*60*1e3),i=new Date(t.getFullYear(),t.getMonth(),1);e=e.filter((e=>{const t=new Date(e.time);switch(this.timeIndex){case 1:return t>=s;case 2:return t>=a;case 3:return t>=i;default:return!0}}))}return e}},methods:{getStaticUrl:e=>t.CONFIG_UTILS.getStaticUrl(e),goBack(){e.index.navigateBack()},handleSearch(){},onStatusChange(e){this.statusIndex=e.detail.value},onTimeChange(e){this.timeIndex=e.detail.value},viewMessage(e){this.selectedMessage={...e},this.showMessageModal=!0,e.read||(e.read=!0)},closeMessageModal(){this.showMessageModal=!1},toggleRead(t){t.read=!t.read,e.index.showToast({title:t.read?"已标记为已读":"已标记为未读",icon:"success"})},deleteMessage(t){e.index.showModal({title:"确认删除",content:`确定要删除来自 "${t.name}" 的留言吗？`,success:s=>{s.confirm&&(this.messages=this.messages.filter((e=>e.id!==t.id)),e.index.showToast({title:"删除成功",icon:"success"}))}})},markAllRead(){e.index.showModal({title:"确认操作",content:"确定要将所有未读留言标记为已读吗？",success:t=>{t.confirm&&(this.messages.forEach((e=>{e.read=!0})),e.index.showToast({title:"操作成功",icon:"success"}))}})},replyMessage(){e.index.showModal({title:"回复功能",content:"回复功能正在开发中，敬请期待！",showCancel:!1,confirmText:"知道了"})}},onLoad(){const t=e.index.getStorageSync("wechat_token"),s=e.index.getStorageSync("userInfo");return t&&s?"admin"!==s.user_type?(e.index.showToast({title:"无管理员权限",icon:"none",duration:2e3}),void setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),2e3)):void 0:(e.index.showToast({title:"请先登录",icon:"none",duration:2e3}),void setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),2e3))}};const a=e._export_sfc(s,[["render",function(t,s,a,i,o,n){return e.e({a:n.getStaticUrl("/static/svg/left.svg"),b:e.o(((...e)=>n.goBack&&n.goBack(...e))),c:e.o(((...e)=>n.markAllRead&&n.markAllRead(...e))),d:n.getStaticUrl("/static/svg/search.svg"),e:e.o([e=>o.searchKeyword=e.detail.value,(...e)=>n.handleSearch&&n.handleSearch(...e)]),f:o.searchKeyword,g:n.getStaticUrl("/static/svg/filter.svg"),h:e.o((e=>o.showFilter=!o.showFilter)),i:o.showFilter},o.showFilter?{j:e.t(o.statusOptions[o.statusIndex]),k:e.o(((...e)=>n.onStatusChange&&n.onStatusChange(...e))),l:o.statusIndex,m:o.statusOptions,n:e.t(o.timeOptions[o.timeIndex]),o:e.o(((...e)=>n.onTimeChange&&n.onTimeChange(...e))),p:o.timeIndex,q:o.timeOptions}:{},{r:e.f(n.filteredMessages,((t,s,a)=>({a:e.n(t.read?"status-read":"status-unread"),b:e.t(t.name),c:e.t(t.time),d:e.t(t.email),e:e.t(t.content),f:n.getStaticUrl(t.read?"/static/svg/eye-off.svg":"/static/svg/eye.svg"),g:e.o((e=>n.toggleRead(t)),t.id),h:e.o((e=>n.deleteMessage(t)),t.id),i:t.id,j:e.o((e=>n.viewMessage(t)),t.id)}))),s:n.getStaticUrl("/static/images/default-avatar.jpg"),t:n.getStaticUrl("/static/svg/delete.svg"),v:0===n.filteredMessages.length},0===n.filteredMessages.length?{w:n.getStaticUrl("/static/svg/message.svg")}:{},{x:o.showMessageModal},o.showMessageModal?{y:e.o(((...e)=>n.closeMessageModal&&n.closeMessageModal(...e))),z:e.t(o.selectedMessage.name),A:e.t(o.selectedMessage.email),B:e.t(o.selectedMessage.time),C:e.t(o.selectedMessage.content),D:e.o(((...e)=>n.replyMessage&&n.replyMessage(...e))),E:e.o(((...e)=>n.closeMessageModal&&n.closeMessageModal(...e))),F:e.o((()=>{})),G:e.o(((...e)=>n.closeMessageModal&&n.closeMessageModal(...e)))}:{})}]]);wx.createPage(a);
