"use strict";const t=require("../../common/vendor.js"),e=require("../../config/config.js"),s=require("../../utils/api.js"),a={components:{FloatingButtons:()=>"../../components/FloatingButtons.js",Loading:()=>"../../components/Loading.js"},data:()=>({isSubmitting:!1,showSuccess:!1,loading:!0,contactInfo:null,formData:{name:"",email:"",subject:"",message:""},errors:{}}),onLoad(){this.loadContactInfo(),this.logPageVisit()},methods:{getStaticUrl:t=>e.CONFIG_UTILS.getStaticUrl(t),async loadContactInfo(){try{this.contactInfo=await s.ApiService.contact.getInfo(),setTimeout((()=>{this.loading=!1}),1500)}catch(t){s.ApiErrorHandler.handleSilent(t)}},validateForm(){this.errors={};let t=!0;this.formData.name.trim()||(this.errors.name="请输入您的姓名",t=!1);return this.formData.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.formData.email.trim())||(this.errors.email="请输入有效的邮箱地址",t=!1):(this.errors.email="请输入您的邮箱",t=!1),this.formData.subject.trim()||(this.errors.subject="请输入留言主题",t=!1),this.formData.message.trim()?this.formData.message.trim().length<10&&(this.errors.message="留言内容至少需要10个字符",t=!1):(this.errors.message="请输入留言内容",t=!1),t},async submitForm(){if(this.validateForm())try{this.isSubmitting=!0;const t={name:this.formData.name.trim(),email:this.formData.email.trim(),subject:this.formData.subject.trim(),message:this.formData.message.trim()};await s.ApiService.contact.submitMessage(t),this.showSuccess=!0,setTimeout((()=>{this.showSuccess=!1}),3e3),this.formData={name:"",email:"",subject:"",message:""}}catch(t){s.ApiErrorHandler.handle(t)}finally{this.isSubmitting=!1}},async logPageVisit(){try{const t={page:"/pages/contact/contact",referer:"undefined"!=typeof document&&document.referrer?document.referrer:"",user_agent:"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:""};await s.ApiService.visit.log(t)}catch(t){console.error("访问日志记录失败:",t)}},copyText(e){t.index.setClipboardData({data:e,success:()=>{t.index.showToast({title:"复制成功",icon:"success"})},fail:()=>{t.index.showToast({title:"复制失败",icon:"error"})}})},goBack(){t.index.navigateBack()}}};if(!Array){(t.resolveComponent("FloatingButtons")+t.resolveComponent("Loading"))()}const r=t._export_sfc(a,[["render",function(e,s,a,r,o,i){return t.e({a:i.getStaticUrl("/static/svg/left.svg"),b:t.o(((...t)=>i.goBack&&i.goBack(...t))),c:i.getStaticUrl("/static/svg/email.svg"),d:t.o((t=>i.copyText("cto@cvun.net"))),e:i.getStaticUrl("/static/svg/wechat.svg"),f:t.o((t=>i.copyText("cto-peter"))),g:i.getStaticUrl("/static/svg/qq.svg"),h:t.o((t=>i.copyText("21312314"))),i:i.getStaticUrl("/static/svg/local.svg"),j:t.o((t=>i.copyText("河南省郑州市"))),k:i.getStaticUrl("/static/svg/github.svg"),l:t.o((t=>i.copyText("github.com/Juveniles-Full-Stack-Developer"))),m:o.formData.name,n:t.o((t=>o.formData.name=t.detail.value)),o:o.errors.name},o.errors.name?{p:t.t(o.errors.name)}:{},{q:o.formData.email,r:t.o((t=>o.formData.email=t.detail.value)),s:o.errors.email},o.errors.email?{t:t.t(o.errors.email)}:{},{v:o.formData.subject,w:t.o((t=>o.formData.subject=t.detail.value)),x:o.errors.subject},o.errors.subject?{y:t.t(o.errors.subject)}:{},{z:o.formData.message,A:t.o((t=>o.formData.message=t.detail.value)),B:o.errors.message},o.errors.message?{C:t.t(o.errors.message)}:{},{D:o.isSubmitting},(o.isSubmitting,{}),{E:o.isSubmitting,F:t.o(((...t)=>i.submitForm&&i.submitForm(...t))),G:o.showSuccess},(o.showSuccess,{}),{H:o.loading})}]]);wx.createPage(r);
