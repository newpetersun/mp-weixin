"use strict";const e=require("../../common/vendor.js"),t=require("../../config/config.js"),o=require("../../utils/api.js"),a={components:{FloatingButtons:()=>"../../components/FloatingButtons.js",Loading:()=>"../../components/Loading.js"},data:()=>({currentCategory:"all",selectedProject:null,loading:!0,categories:[],projects:[],error:null}),computed:{filteredProjects(){return"all"===this.currentCategory?this.projects:this.projects.filter((e=>this.getCategoryKey(e.category_id)===this.currentCategory))}},onLoad(){this.loadData()},onShareAppMessage:()=>({title:"乔布斯于科技世界种下创新种子，罗永浩在行业浪潮里坚守情怀高地，都让我着迷。我仿佛看到老罗和乔布斯在科技和人文的十字路口探讨人生，所以我带着这份情怀，期待在这里与你相遇。",path:"/pages/projects/projects",success:function(e){console.log("分享成功")},fail:function(e){console.log("分享失败")}}),onUnload(){},methods:{async loadData(){this.loading=!0,this.error=null;try{const[e,t]=await Promise.all([o.ApiService.project.getCategories(),o.ApiService.project.getList()]);let a=e;a&&0!==a.length||(console.log("使用测试分类数据"),a=[{key:"web",name:"Web开发"},{key:"mobile",name:"移动开发"},{key:"design",name:"UI设计"},{key:"data",name:"数据分析"}]),this.categories=this.validateCategories(a),this.projects=t.list,setTimeout((()=>{this.loading=!1}),1500)}catch(e){this.error=e.message||"数据加载失败",o.ApiErrorHandler.handle(e)}finally{setTimeout((()=>{this.loading=!1}),1500)}},getStaticUrl:e=>t.CONFIG_UTILS.getStaticUrl(e),selectCategory(e){this.currentCategory=e},showProjectDetail(t){t&&t.title?e.index.navigateTo({url:`/pages/project/detail?id=${t.id}`}):e.index.showToast({title:"项目数据不完整",icon:"none"})},closeProjectDetail(){this.selectedProject=null},goBack(){e.index.navigateBack()},async refreshData(){await this.loadData()},validateCategories:e=>Array.isArray(e)?e.map((e=>({key:e.key||e.name||"unknown",name:e.name||"未命名分类"}))):(console.warn("分类数据不是数组格式:",e),[]),getCategoryName(e){if(!e)return"其他";return{1:"Web开发",2:"移动开发",3:"UI设计",4:"数据分析"}[e]||"其他"},getCategoryKey(e){if(!e)return"other";return{1:"web",2:"mobile",3:"design",4:"data"}[e]||"other"}}};if(!Array){(e.resolveComponent("Loading")+e.resolveComponent("FloatingButtons"))()}const r=e._export_sfc(a,[["render",function(t,o,a,r,i,s){return e.e({a:s.getStaticUrl("/static/svg/left.svg"),b:e.o(((...e)=>s.goBack&&s.goBack(...e))),c:e.f(i.categories,((t,o,a)=>({a:e.t(t.name),b:o,c:i.currentCategory===t.key?1:"",d:e.o((e=>s.selectCategory(t.key)),o)}))),d:e.f(s.filteredProjects,((t,o,a)=>({a:s.getStaticUrl(t.image&&t.image[0]||"/static/images/default-project.png"),b:e.t(t.title),c:e.t(t.description),d:e.f(t.tags,((t,o,a)=>({a:e.t(t),b:t}))),e:o,f:e.o((e=>s.showProjectDetail(t)),o)}))),e:i.selectedProject},i.selectedProject?{f:e.t(i.selectedProject.title),g:e.o(((...e)=>s.closeProjectDetail&&s.closeProjectDetail(...e))),h:s.getStaticUrl(i.selectedProject.image||"/static/images/default-project.png"),i:e.t(i.selectedProject.fullDescription),j:e.f(i.selectedProject.features,((t,o,a)=>({a:e.t(t),b:t}))),k:e.f(i.selectedProject.technologies,((t,o,a)=>({a:e.t(t),b:t}))),l:e.o((()=>{})),m:e.o(((...e)=>s.closeProjectDetail&&s.closeProjectDetail(...e)))}:{},{n:i.loading})}]]);a.__runtimeHooks=2,wx.createPage(r);
