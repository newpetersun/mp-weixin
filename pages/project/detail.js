"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/api.js"),r=require("../../config/config.js"),i={components:{Loading:()=>"../../components/Loading.js"},data:()=>({project:null,loading:!0,error:null,projectId:null,activeTab:"intro",projectRequirements:[],statusFilter:"all",currentSwiperIndex:0,swiperInstance:null}),computed:{filteredRequirements(){return this.projectRequirements&&this.projectRequirements.length?"all"===this.statusFilter?this.projectRequirements:this.projectRequirements.filter((e=>e.status===this.statusFilter)):[]}},onLoad(e){e.id?(this.projectId=e.id,this.loadProjectDetail()):(this.error="项目ID不能为空",this.loading=!1)},onShareAppMessage(){return{title:this.project.title,path:"/pages/project/detail?id="+this.projectId,success:function(e){console.log("分享成功")},fail:function(e){console.log("分享失败")}}},methods:{getStaticUrl:e=>r.CONFIG_UTILS.getStaticUrl(e),swiperPrev(){if(this.project&&Array.isArray(this.project.images)){let e=this.project.images.length;if(e<=1)return;let t=this.currentSwiperIndex-1;t<0&&(t=e-1),this.setCurrentSwiperIndex(t)}},swiperNext(){if(this.project&&Array.isArray(this.project.images)){let e=this.project.images.length;if(e<=1)return;let t=this.currentSwiperIndex+1;t>=e&&(t=0),this.setCurrentSwiperIndex(t)}},setCurrentSwiperIndex(e){this.currentSwiperIndex=e,this.$refs.projectSwiper&&(this.$refs.projectSwiper.currentIndex=e)},onSwiperChange(e){this.currentSwiperIndex=e.detail.current},goBack(){e.index.navigateBack()},async loadProjectDetail(){try{this.error=null;const e=await t.ApiService.project.getDetail(this.projectId);console.log("项目详情响应:",e),e?(this.project=e,this.projectRequirements=e.requirements,setTimeout((()=>{this.loading=!1}),1500)):(this.error=e.message||"加载失败",setTimeout((()=>{this.loading=!1}),1500))}catch(e){console.error("加载项目详情失败:",e),this.error="网络错误，请稍后重试"}finally{setTimeout((()=>{this.loading=!1}),1500)}},switchTab(e){this.activeTab=e},getStatusText:e=>({1:"已发布",0:"草稿",2:"已归档"}[e]||"未知"),getLinkText:e=>({github:"GitHub",demo:"在线演示",documentation:"文档",video:"视频介绍"}[e]||e),openLink(t){t.url&&e.index.setClipboardData({data:t.url,success:()=>{e.index.showToast({title:"链接已复制到剪贴板",icon:"success"})}})},formatTime(e){if(!e)return"";return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})},getRequirementStatusText:e=>({pending:"待开始",progress:"进行中",completed:"已完成",cancelled:"已取消"}[e]||"未知"),getPriorityText:e=>({low:"低",medium:"中",high:"高",urgent:"紧急"}[e]||"未知"),getCompletedCount(){return this.projectRequirements.filter((e=>"completed"===e.status)).length},getProgressCount(){return this.projectRequirements.filter((e=>"progress"===e.status)).length},getPendingCount(){return this.projectRequirements.filter((e=>"pending"===e.status)).length},setStatusFilter(e){this.statusFilter=e},getStatusFilterText(){return{all:"全部",completed:"已完成",progress:"进行中",pending:"未开始"}[this.statusFilter]||"全部"},getProgressPercent(e){if(!e.estimated_hours||!e.actual_hours)return 0;const t=e.actual_hours/e.estimated_hours*100;return Math.min(Math.round(t),100)}}};if(!Array){e.resolveComponent("Loading")()}const s=e._export_sfc(i,[["render",function(t,r,i,s,o,n){return e.e({a:n.getStaticUrl("/static/svg/left.svg"),b:e.o(((...e)=>n.goBack&&n.goBack(...e))),c:o.project},o.project?e.e({d:Array.isArray(o.project.images)&&o.project.images.length>0},Array.isArray(o.project.images)&&o.project.images.length>0?{e:e.f(o.project.images,((e,t,r)=>({a:n.getStaticUrl(e),b:t})))}:{},{f:e.o(((...e)=>n.onSwiperChange&&n.onSwiperChange(...e))),g:"intro"===o.activeTab?1:"",h:e.o((e=>n.switchTab("intro"))),i:"requirements"===o.activeTab?1:"",j:e.o((e=>n.switchTab("requirements"))),k:e.t(o.project.title),l:e.t(o.project.description),m:e.t(n.getStatusText(o.project.status)),n:e.n(`status-${o.project.status}`),o:o.project.technologies&&o.project.technologies.length},o.project.technologies&&o.project.technologies.length?{p:e.f(o.project.technologies,((t,r,i)=>({a:n.getStaticUrl(t.img||"/static/images/default-tech.png"),b:e.t(t.name),c:t.id})))}:{},{q:o.project.links&&o.project.links.length},o.project.links&&o.project.links.length?{r:e.f(o.project.links,((t,r,i)=>({a:n.getStaticUrl(`/static/svg/${t.type}.svg`),b:e.t(n.getLinkText(t.type)),c:t.type,d:e.o((e=>n.openLink(t)),t.type)}))),s:n.getStaticUrl("/static/svg/arrow-right.svg")}:{},{t:o.project.content},o.project.content?{v:e.t(o.project.content)}:{},{w:e.t(n.formatTime(o.project.create_time)),x:o.project.update_time},o.project.update_time?{y:e.t(n.formatTime(o.project.update_time))}:{},{z:"intro"===o.activeTab,A:o.projectRequirements&&o.projectRequirements.length},o.projectRequirements&&o.projectRequirements.length?{B:e.t(o.projectRequirements.length),C:"all"===o.statusFilter?1:"",D:e.o((e=>n.setStatusFilter("all"))),E:e.t(n.getCompletedCount()),F:"completed"===o.statusFilter?1:"",G:e.o((e=>n.setStatusFilter("completed"))),H:e.t(n.getProgressCount()),I:"progress"===o.statusFilter?1:"",J:e.o((e=>n.setStatusFilter("progress"))),K:e.t(n.getPendingCount()),L:"pending"===o.statusFilter?1:"",M:e.o((e=>n.setStatusFilter("pending")))}:{},{N:n.filteredRequirements&&n.filteredRequirements.length},n.filteredRequirements&&n.filteredRequirements.length?{O:e.f(n.filteredRequirements,((t,r,i)=>e.e({a:e.t(t.title),b:e.t(n.getRequirementStatusText(t.status)),c:e.n(`status-${t.status}`),d:e.t(t.description),e:e.t(n.getPriorityText(t.priority)),f:e.n(`priority-${t.priority}`),g:t.assignee},t.assignee?{h:e.t(t.assignee)}:{},{i:t.estimated_hours},t.estimated_hours?{j:e.t(t.estimated_hours)}:{},{k:t.actual_hours},t.actual_hours?{l:e.t(t.actual_hours)}:{},{m:e.t(n.formatTime(t.create_time)),n:t.update_time&&t.update_time!==t.create_time},t.update_time&&t.update_time!==t.create_time?{o:e.t(n.formatTime(t.update_time))}:{},{p:t.estimated_hours&&t.actual_hours&&"completed"!==t.status},t.estimated_hours&&t.actual_hours&&"completed"!==t.status?{q:e.t(n.getProgressPercent(t)),r:n.getProgressPercent(t)+"%"}:{},{s:t.id})))}:o.projectRequirements&&o.projectRequirements.length&&n.filteredRequirements&&!n.filteredRequirements.length?{R:e.t(n.getStatusFilterText())}:{},{P:!o.projectRequirements||!o.projectRequirements.length,Q:n.filteredRequirements&&!n.filteredRequirements.length,S:"requirements"===o.activeTab}):{},{T:o.loading,U:o.error},o.error?{V:e.t(o.error),W:e.o(((...e)=>n.loadProjectDetail&&n.loadProjectDetail(...e)))}:{})}],["__scopeId","data-v-2725ecd3"]]);i.__runtimeHooks=2,wx.createPage(s);
